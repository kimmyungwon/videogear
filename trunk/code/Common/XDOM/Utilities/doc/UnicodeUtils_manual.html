<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Unicode Utility Library 4.0.2</title><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="d110e3"></a>Unicode Utility Library 4.0.2</h2></div><div><h3 class="subtitle"><i>Delphi 4 to 2007 and Kylix 3 Implementation</i></h3></div><div><div class="author"><h3 class="author"><span class="firstname">Dieter</span> <span class="surname">Köhler</span></h3></div></div><div><div class="othercredit"><h3 class="othercredit"></h3><span class="contrib">Special thanks to (in alphabetical order): Lucjan &#321;yczak, Micha Nelissen, Ernst van der Pols and Karl Waclawek.</span>&nbsp;</div></div><div><div class="legalnotice"><a name="d110e25"></a><p>LICENSE</p><p>The contents of the Extended Document Object Model files are subject to the Mozilla Public License Version 1.1 (the "License"); you may not use this files except in compliance with the License. You may obtain a copy of the License at "http://www.mozilla.org/MPL/"</p><p>Software distributed under the License is distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language governing rights and limitations under the License.</p><p>The Original Code is "UnicodeUtils.pas".</p><p>The Initial Developer of the Original Code is Dieter Köhler (Heidelberg, Germany, "http://www.philo.de/"). Portions created by the Initial Developer are Copyright (C) 1999-2007 Dieter Köhler. All Rights Reserved.</p><p>Alternatively, the contents of this files may be used under the terms of the GNU General Public License Version 2 or later (the "GPL"), in which case the provisions of the GPL are applicable instead of those above. If you wish to allow use of your version of this files only under the terms of the GPL, and not to allow others to use your version of this files under the terms of the MPL, indicate your decision by deleting the provisions above and replace them with the notice and other provisions required by the GPL. If you do not delete the provisions above, a recipient may use your version of this file under the terms of any one of the MPL or the GPL.</p></div></div><div><p class="pubdate">2004-2007</p></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="sect1"><a href="#d110e43">Introduction</a></span></dt><dt><span class="sect1"><a href="#d110e54">Helper Functions for Encoding Type Detection</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d110e57">EncodingToStr</a></span></dt><dt><span class="sect2"><a href="#d110e83">StrToEncoding</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d110e102">Helper Functions for UTF-16 Surrogate Processing</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d110e107">Utf16HighSurrogate</a></span></dt><dt><span class="sect2"><a href="#d110e133">Utf16LowSurrogate</a></span></dt><dt><span class="sect2"><a href="#d110e159">Utf16SurrogateToInt</a></span></dt><dt><span class="sect2"><a href="#d110e189">IsUtf16HighSurrogate</a></span></dt><dt><span class="sect2"><a href="#d110e208">IsUtf16LowSurrogate</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d110e227">Conversion Functions between UTF-8 and UTF-16BE</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d110e230">UTF8ToUTF16BEStr</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d110e256">CSMIB classes</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d110e261">CSMIB Exception Classes</a></span></dt><dt><span class="sect2"><a href="#d110e268">CSMIB Event Classes</a></span></dt><dt><span class="sect2"><a href="#d110e275">The TCSMIB Class</a></span></dt></dl></dd><dt><span class="bibliography"><a href="#d110e349">References</a></span></dt></dl></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d110e43"></a>Introduction</h2></div></div></div><p>The Unicode Utility Library (UUL) contains several classes and helper functions to support processing and conversion of Unicode character data.  Unicode is a character encoding standard that covers all major scripts of the world.  For more information on Unicode and its related standards see the resources mentioned in the References section.  The conversion functions are based on the mapping tables which can be found on the CD-ROM accompanying [Unicode 3.0].</p><p>Also included is a TCSMIB component for easy access to the Management Information Base (MIB) for character set encodings as specified in [CSMIB].  (This specification is occasionally used in the documentation below even if not explicitly quoted.)</p><p>To use the UUL in a Delphi unit just include a reference to UnicodeConv in its uses clause and make sure that the location of the file UnicodeConv.pas is included in the library path list of your Delphi IDE.  To use the TCSMIB component at design time you must install the unit as part of a Delphi design time package. If not already available, a new "Unicode" palette page will appear containing the TCSMIB component.</p><p>The UUL is under permanent development. The latest version of this Software can be obtained via the OpenXML web-site at "http://www.philo.de/xml/".  The preferred way to contact the author is via the OpenXML mailing list.  Instructions how to join the mailing list can be found at "http://www.philo.de/xml/" as well.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d110e54"></a>Helper Functions for Encoding Type Detection</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e57"></a>EncodingToStr</h3></div></div></div><pre class="synopsis">function EncodingToStr(const CodecClass: TUnicodeCodecClass): string;</pre><p>Returns the standard name of the specified character encoding.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e64"></a>Parameters</h4></div></div></div><pre class="synopsis">CodecClass</pre><p>The codec class of a character encoding.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e71"></a>Return Value</h4></div></div></div><p>The standard name of the specified character encoding.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e76"></a>Exceptions</h4></div></div></div><pre class="synopsis">EConvertError</pre><p>Raised if no encoding class was specified.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e83"></a>StrToEncoding</h3></div></div></div><pre class="synopsis">function StrToEncoding(const S: string): TUnicodeCodecClass;</pre><p>Returns the codec class for a character encoding.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e90"></a>Parameters</h4></div></div></div><pre class="synopsis">S</pre><p>The name of a character encoding.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e97"></a>Return Value</h4></div></div></div><p>The codec class of the specified character encoding, or nil if no codec class is available.</p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d110e102"></a>Helper Functions for UTF-16 Surrogate Processing</h2></div></div></div><p>The following functions serve for UTF-16 surrogate processing:</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e107"></a>Utf16HighSurrogate</h3></div></div></div><pre class="synopsis">function UTF16HighSurrogate(const Value: Integer): WideChar;</pre><p>Extracts the high surrogate of a number out of the interval [$10000;$10FFFF].</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e114"></a>Parameters</h4></div></div></div><pre class="synopsis">Value</pre><p>The number from which the high surrogate is to be extracted.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e121"></a>Return Value</h4></div></div></div><p>The high surrogate as a WideChar.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e126"></a>Exceptions</h4></div></div></div><pre class="synopsis">EConvertError</pre><p>This Delphi exception is raised if the specified value is not contained in the interval [$10000;$10FFFF].</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e133"></a>Utf16LowSurrogate</h3></div></div></div><pre class="synopsis">function UTF16LowSurrogate(const Value: Integer): WideChar;</pre><p>Extracts the low surrogate of a number out of the interval [$10000;$10FFFF].</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e140"></a>Parameters</h4></div></div></div><pre class="synopsis">Value</pre><p>The number from which the low surrogate is to be extracted.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e147"></a>Return Value</h4></div></div></div><p>The low surrogate as a WideChar.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e152"></a>Exceptions</h4></div></div></div><pre class="synopsis">EConvertError</pre><p>This Delphi exception is raised if the specified value is not contained in the interval [$10000;$10FFFF].</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e159"></a>Utf16SurrogateToInt</h3></div></div></div><pre class="synopsis">function UTF16SurrogateToInt(const HighSurrogate, LowSurrogate: WideChar): Integer;</pre><p>Transforms a high surrogate plus a low surrogate into an integer.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e166"></a>Parameters</h4></div></div></div><pre class="synopsis">HighSurrogate</pre><p>The high surrogate part of the integer.</p><pre class="synopsis">LowSurrogate</pre><p>The low surrogate part of the integer.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e177"></a>Return Value</h4></div></div></div><p>The integer value of the high surrogate plus the low surrogat.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e182"></a>Exceptions</h4></div></div></div><pre class="synopsis">EConvertError</pre><p>This Delphi exception is raised if the ordinal value of the highSurrogate is not contained in the interval [$D800;$DBFF] or if the ordinal value of the lowSurrogate is not contained in the interval [$DC00;$DFFF].</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e189"></a>IsUtf16HighSurrogate</h3></div></div></div><pre class="synopsis">function IsUtf16HighSurrogate(const S: WideChar): Boolean;</pre><p>Tests whether the specified WideChar is an UTF16 high surrogate.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e196"></a>Parameters</h4></div></div></div><pre class="synopsis">S</pre><p>The WideChar to test.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e203"></a>Return Value</h4></div></div></div><p>'True' if the specified WideChar is an UTF16 high surrogate, otherwise 'false'.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e208"></a>IsUtf16LowSurrogate</h3></div></div></div><pre class="synopsis">function IsUtf16LowSurrogate(const S: WideChar): Boolean;</pre><p>Tests whether the specified WideChar is an UTF16 low surrogate.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e215"></a>Parameters</h4></div></div></div><pre class="synopsis">S</pre><p>The WideChar to test.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e222"></a>Return Value</h4></div></div></div><p>'True' if the specified WideChar is an UTF16 low surrogate, otherwise 'false'.</p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d110e227"></a>Conversion Functions between UTF-8 and UTF-16BE</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e230"></a>UTF8ToUTF16BEStr</h3></div></div></div><pre class="synopsis">function UTF8ToUTF16BEStr(const S: string): WideString;</pre><p>Converts an UTF-8 string into an UTF-16BE wideString. No special conversions (e.g. on line breaks) and no XML-Char checking are done.  If 'S' starts with a byte order mark (#$EF #$BB #$BF) the byte order mark is skipped.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e237"></a>Parameters</h4></div></div></div><pre class="synopsis">w</pre><p>The UTF-8 string to be converted.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e244"></a>Return Value</h4></div></div></div><p>The content of 's' as an UTF-16BE wideString starting with a byte order mark.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e249"></a>Exceptions</h4></div></div></div><pre class="synopsis">EConvertError</pre><p>This Delphi exception is raised if 's' contains an invalid UTF-8 sequence.</p></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d110e256"></a>CSMIB classes</h2></div></div></div><p>These classes are designed for easy access to the Management Information Base (MIB) for character set encodings as specified in [CSMIB].</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e261"></a>CSMIB Exception Classes</h3></div></div></div><pre class="synopsis">ECSMIBException = Exception;</pre><p>ECSMIBException is the exception class for errors in the TCSMIB class.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e268"></a>CSMIB Event Classes</h3></div></div></div><pre class="synopsis">TCSMIBChangingEvent = procedure (Sender: TObject;
                                  NewEnum: Integer;
                                  var AllowChange: Boolean) of object;</pre><p>This event class is used for the TCSMIB.OnChanging event.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d110e275"></a>The TCSMIB Class</h3></div></div></div><p>The TCSMIB component decodes MIB enumaration (MIBenum) values which identify coded character sets as specified in [CSMIB].</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e280"></a>Published Properties</h4></div></div></div><pre class="synopsis">property Enum: Integer</pre><p>The Enum property contains the unique MIB enum value to identify a coded character set.</p><p>If on setting an invalid value is specified then, depending on the value of the IgnoreInvalidEnum property, either an ECSMIBException is raised or the attempt is silently ignored.</p><pre class="synopsis">property IgnoreInvalidEnum: Boolean</pre><p>If set to TRUE an attempt to set the Enum property to an invalid value is silently ignored, i.e. Enum will remain the same and no notification about the failure is made.</p><p>If set to FALSE an attempt to set the Enum property to an invalid value results in an ECSMIBException being raised.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e295"></a>Public Properties</h4></div></div></div><pre class="synopsis">property Alias[I: Integer]: string (readonly)</pre><p>This property gives access to a list of official names for the character set with the MIB enum value specified in the Enum property.</p><p>These names are expressed in ANSI_X3.4-1968, also known as US-ASCII or simply ASCII.  The names are not case-sensitive.</p><p>The aliases that start with "cs" have been added for use with the Printer MIB (see RFC 1759) and contain the standard numbers along with suggestive names in order to facilitate applications that want to display the names in user interfaces.  The "cs" stands for character set and is provided for applications that need a lower case first letter but wan to use mixed case thereafter that cannot contain any special characters, such as underbar ("_") and dash ("-").</p><p>The i parameter corresponds to the position of an alias in the list, where 0 is the first alias, 1 is the second alias, and so on.  If there is no alias corresponding to the value of i, an ECSMIBException is raised.</p><p>The first alias, i.e. Alias[0], always contains the MIB name of the corresponding character set.</p><pre class="synopsis">property AliasCount: Integer (readonly)</pre><p>This property represents the number of aliases in the list for the names of the coded character set with the MIB enum value specified in the Enum property.</p><p>Use the AliasCount property when iterating over all the aliases in the list, or when trying to locate the position of an alias relative to the last alias in the list.</p><pre class="synopsis">property PreferredMIMEName: string (readonly)</pre><p>This property contains the preferred MIME Name, if any, of the coded character set with the MIB enum value specified in the Enum property.  If no such preferred MIME name is specified this is an empty string.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e321"></a>Public Methods</h4></div></div></div><pre class="synopsis">function IsValidEnum(const Value: integer): Boolean; virtual;</pre><p>Returns TRUE if the specified value is a valid MIBenum value.  Otherwise FALSE is returned.</p><pre class="synopsis">function SetToAlias(const S: string): Boolean; virtual;</pre><p>Tries to set the Enum property to a value corresponding to the specified string.  No distinction is made between use of upper and lower case letters.  If the attempt was successful, TRUE is return.  Otherwise False is returnd and the value of the Enum property remains the same.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d110e332"></a>Events</h4></div></div></div><pre class="synopsis">OnChange: TNotifyEvent</pre><p>Occures after the Enum property changed.</p><p>type TNotifyEvent = procedure (Sender: TObject) of object;</p><pre class="synopsis">OnChanging: TCSMIBChangingEvent</pre><p>Occures just before a change is made to the Enum property.</p><p>TCSMIBChangingEvent = procedure (Sender: TObject;
                                     NewEnum: Integer;
                                     var AllowChange: Boolean) of object;</p><p>Write an OnChanging event handler to conditionally block changes to the Enum property. Set the AllowChange parameter to FALSE to prevent the change from taking place. The NewEnum parameter is the new Enum value about to be set.</p></div></div></div><div class="bibliography"><div class="titlepage"><div><div><h2 class="title"><a name="d110e349"></a>References</h2></div></div></div><div class="bibliomixed"><a name="d110e352"></a><p class="bibliomixed">[CSMIB] IANA: Character Sets, 2001-08-23, see: "http://www.iana.org/assignments/character-sets".</p></div><div class="bibliomixed"><a name="d110e354"></a><p class="bibliomixed">[ISO/IEC 10646] ISO (International Organization for Standardization): ISO/IEC 10646-1993 (E). Information technology &#8211; Universal Multiple-Octet Coded Character Set (UCS) &#8211; Part 1: Architecture and Basic Multilingual Plane, [Geneva]: International Organization for Standardization, 1993 (+ amendments AM 1&#8211;7).</p></div><div class="bibliomixed"><a name="d110e356"></a><p class="bibliomixed">[RFC 2279] Yergeau, F.: "UTF-8, a Transformation Format of ISO 10646", RFC 2279, 1998, see "http://www.ietf.org/rfc/rfc2279.txt".</p></div><div class="bibliomixed"><a name="d110e358"></a><p class="bibliomixed">[RFC 2781] Hoffman, P. and F. Yergeau: "UTF-16, an Encoding of ISO 10646", RFC 2781, 2000, see "http://www.ietf.org/rfc/rfc2781.txt".</p></div><div class="bibliomixed"><a name="d110e360"></a><p class="bibliomixed">[Unicode 3.0] The Unicode Consortium: The Unicode Standard Version 3.0, Reading (Mass.): Addison-Wesley, 2000.</p></div></div></div></body></html>